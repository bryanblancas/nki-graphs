define(["ojs/ojcontext","ojs/ojresponsiveutils","ojs/ojresponsiveknockoututils","knockout","ojs/ojarraydataprovider","ojs/ojknockout","ojs/ojknockout","ojs/ojinputtext","ojs/ojinputnumber","ojs/ojselectsingle","ojs/ojchart","./scalesEquivalences"],(function(e,a,t,s,o){const l=()=>({name:s.observable("New"),value:s.observable(),scale:s.observable("pc"),peScale:s.observable(),color:s.observable()});return e.getPageContext().getBusyContext().applicationBootstrapComplete(),new function(){const e=a.getFrameworkQuery(a.FRAMEWORK_QUERY_KEY.SM_ONLY);this.smScreen=t.createMediaQueryObservable(e),this.scales=[{value:"pc",label:"Percentil"},{value:"s",label:"S Escala típica"},{value:"de",label:"Decatipo"},{value:"en",label:"Eneatipo"},{value:"t",label:"T Escala típica"},{value:"cl",label:"Cl Escala Típica"},{value:"pe",label:"Puntuación Escalar"},{value:"z",label:"Puntuación Z"}],this.scalesDp=new o(this.scales,{keyAttributes:"value"}),this.graphCategories=s.observableArray([l()]),this.dataProvider=new o(this.graphCategories,{keyAttributes:"name"}),this.chartData=s.observableArray([]),this.chartDataDp=new o(this.chartData,{keyAttributes:"id"}),this.maxY=s.observable(100),this.stepY=s.observable(10),this.handleCatValueChanged=(e,a,t)=>{const s=a.data.value(),o=a.data.scale();s&&o?a.data.peScale(((e,a)=>{if(console.log(`About to transform ${e} from ${a} to Percentile`),"pc"===a)return e;const t=SCALES_EQUIVALENCES[a],s=SCALES_EQUIVALENCES.pc;let o=0;for(;o<t.length;){if(!(t[o]<e)){if(t[o]===e)break;o--;break}o++}return s[o]})(s,o)):a.data.peScale("n/a")},this.handleAddCategory=()=>{this.graphCategories.push(l())},this.handleRemoveCategory=(e,a,t)=>{this.graphCategories.remove(a.data)},this.handleGraph=()=>{const e=this.graphCategories().map(((e,a)=>((e,a)=>({id:a,group:e.name(),value:e.peScale(),color:e.color()}))(e,a)));this.chartData(e)}}}));