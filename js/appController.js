define(["ojs/ojcontext","ojs/ojresponsiveutils","ojs/ojresponsiveknockoututils","knockout","ojs/ojarraydataprovider","ojs/ojknockout","ojs/ojknockout","ojs/ojinputtext","ojs/ojinputnumber","ojs/ojselectsingle","ojs/ojchart"],(function(e,a,t,o,s){const l={pc:[1,1,1,2,2,4,4,7,13,18,22,27,33,37,41,48,52,58,63,67,73,78,82,87,93,96,96,98,98,98,99,99,99,99],s:[1,1,2,7,11,14,16,21,27,31,35,38,41,44,46,49,51,54,56,59,62,65,69,73,79,84,85,89,91,93,96,98,99,99],de:[1,1,1,1,2,2,2,3,3,4,4,4,5,5,5,5,6,6,6,6,7,7,7,8,8,9,9,9,10,10,10,10,10,10],en:[1,1,1,1,1,1,2,2,3,3,3,4,4,4,5,5,5,5,6,6,6,7,7,7,8,8,9,9,9,9,9,9,9,9],t:[25,26,26,28,30,32,33,36,39,41,42,44,46,47,48,49,51,52,53,55,56,58,59,62,64,67,68,70,71,72,73,74,75,76],cl:[62,63,64,67,71,73,75,78,83,86,89,91,93,95,97,99,101,103,105,107,109,111,114,117,122,126,126,129,131,132,135,136,137,138],pe:[2,3,3,3,4,5,5,6,7,7,8,8,9,9,9,10,10,11,11,11,12,12,13,13,14,15,15,16,16,16,17,17,17,18],z:[-2.5,-2.45,-2.4,-2.17,-1.96,-1.81,-1.7,-1.44,-1.15,-.93,-.76,-.6,-.45,-.32,-.19,-.06,.06,.19,.32,.45,.6,.76,.93,1.15,1.44,1.7,1.75,1.96,2.05,2.15,2.3,2.4,2.45,2.5]},r=()=>({name:o.observable("New"),value:o.observable(),scale:o.observable("pc"),peScale:o.observable(),color:o.observable()});return e.getPageContext().getBusyContext().applicationBootstrapComplete(),new function(){const e=a.getFrameworkQuery(a.FRAMEWORK_QUERY_KEY.SM_ONLY);this.smScreen=t.createMediaQueryObservable(e),this.scales=[{value:"pc",label:"Percentil"},{value:"s",label:"S Escala típica"},{value:"de",label:"Decatipo"},{value:"en",label:"Eneatipo"},{value:"t",label:"T Escala típica"},{value:"cl",label:"Cl Escala Típica"},{value:"pe",label:"Puntuación Escalar"},{value:"z",label:"Puntuación Z"}],this.scalesDp=new s(this.scales,{keyAttributes:"value"}),this.graphCategories=o.observableArray([r()]),this.dataProvider=new s(this.graphCategories,{keyAttributes:"name"}),this.chartData=o.observableArray([]),this.chartDataDp=new s(this.chartData,{keyAttributes:"id"}),this.maxY=o.observable(100),this.stepY=o.observable(10),this.handleCatValueChanged=(e,a,t)=>{const o=a.data.value(),s=a.data.scale();o&&s?a.data.peScale(((e,a)=>{if(console.log(`About to transform ${e} from ${a} to Percentile`),"pc"===a)return e;const t=l[a],o=l.pc;let s=0;for(;s<t.length;){if(!(t[s]<e)){if(t[s]===e)break;s--;break}s++}return o[s]})(o,s)):a.data.peScale("n/a")},this.handleAddCategory=()=>{this.graphCategories.push(r())},this.handleRemoveCategory=(e,a,t)=>{this.graphCategories.remove(a.data)},this.handleGraph=()=>{const e=this.graphCategories().map(((e,a)=>((e,a)=>({id:a,group:e.name(),value:e.peScale(),color:e.color()}))(e,a)));this.chartData(e)}}}));